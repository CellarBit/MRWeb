<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Oware (Abapa) Game</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            background-color: #f4f4f4;
            font-family: Arial, sans-serif;
        }

        #current-turn {
            margin-top: 20px;
            font-size: 24px;
            font-weight: bold;
        }

        #board-container {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        #game-board {
            display: grid;
            grid-template-rows: repeat(2, 80px);
            grid-template-columns: repeat(6, 80px);
            gap: 10px;
            background-image: url('https://images.pexels.com/photos/164005/pexels-photo-164005.jpeg');
            background-size: cover;
            padding: 20px;
            border: 8px solid #8B4513;
            border-radius: 25%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .hole {
            width: 70px;
            height: 70px;
            border: 1px solid black;
            display: inline-block;
            margin: 5px;
            position: relative;
            text-align: center; /* Center text horizontally */
            line-height: 70px; /* Center text vertically */
            font-size: 20px; /* Adjust font size */
            font-weight: bold; /* Make numbers bold */
            border-radius: 40%;
        }

        .player1-holes {
            background-color: #add8e6;
        }

        .player2-holes {
            background-color: #ffcccb;
        }

        .seed {
            width: 10px;
            height: 10px;
            background-color: #8B4513;
            border-radius: 50%;
            position: absolute;
        }

        #stores {
            margin-top: 20px;
            font-size: 18px;
            text-align: center;
        }

        #stores p {
            margin: 5px 0;
        }
        #toggle-seeds {
            margin-top: 10px;
        }
        /* Add this to your existing CSS */
        #game-over {
            margin-top: 20px;
            font-size: 24px;
            font-weight: bold;
            color: #8B4513;
            display: none; /* Hidden by default */
        }

        .hole.disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <!-- [Same HTML structure as before] -->
    <div id="current-turn">Player 1's Turn</div>
    <div id="board-container">
        <div id="game-board">
            <!-- Player 2's holes (Top row, right to left for counter-clockwise) -->
            <div class="hole player2-holes" id="hole11"></div>
            <div class="hole player2-holes" id="hole10"></div>
            <div class="hole player2-holes" id="hole9"></div>
            <div class="hole player2-holes" id="hole8"></div>
            <div class="hole player2-holes" id="hole7"></div>
            <div class="hole player2-holes" id="hole6"></div>
            <!-- Player 1's holes (Bottom row, left to right) -->
            <div class="hole player1-holes" id="hole0"></div>
            <div class="hole player1-holes" id="hole1"></div>
            <div class="hole player1-holes" id="hole2"></div>
            <div class="hole player1-holes" id="hole3"></div>
            <div class="hole player1-holes" id="hole4"></div>
            <div class="hole player1-holes" id="hole5"></div>
        </div>
    </div>
    <div id="stores">
        <p>Player 1 Store: <span id="store1">0</span></p>
        <p>Player 2 Store: <span id="store2">0</span></p>
    </div>
    <label for="toggle-seeds">
        <input type="checkbox" id="toggle-seeds"> Show Numbers Instead of Seeds
    </label>
    <script>
         let currentPlayer = 'player1';
        const board = {
            holes: [4, 4, 4, 4, 4, 4,  // Player 1's holes (indexes 0-5)
                    4, 4, 4, 4, 4, 4], // Player 2's holes (indexes 6-11)
            store1: 0,
            store2: 0
        };

        // Toggle between seeds and numbers
        const toggleSeedsCheckbox = document.getElementById('toggle-seeds');
        toggleSeedsCheckbox.addEventListener('change', () => {
            updateBoard();
        });

        function updateBoard() {
            const showNumbers = toggleSeedsCheckbox.checked;

            for (let i = 0; i < 12; i++) {
                const holeElement = document.getElementById(`hole${i}`);
                holeElement.innerHTML = '';
                const seedCount = board.holes[i];

                if (showNumbers) {
                    // Display the number of seeds centered in the hole
                    holeElement.textContent = seedCount;
                } else {
                    // Display seeds as images
                    const centerX = 35; // Half of hole width
                    const centerY = 35; // Half of hole height
                    let radiusStep = 6; // Distance between circles
                    let seedsPlaced = 0;

                    // Calculate the number of layers needed
                    let layers = Math.ceil((Math.sqrt(seedCount)));
                    let seedsPerLayer = [];

                    // Distribute seeds among layers
                    let remainingSeeds = seedCount;
                    for (let layer = 1; remainingSeeds > 0; layer++) {
                        let seedsInLayer = layer * 6;
                        if (layer === 1) seedsInLayer = 1; // Center seed
                        if (remainingSeeds < seedsInLayer) seedsInLayer = remainingSeeds;

                        seedsPerLayer.push({layer: layer, count: seedsInLayer});
                        remainingSeeds -= seedsInLayer;
                    }

                    // Place seeds layer by layer
                    seedsPerLayer.forEach(item => {
                        const layer = item.layer;
                        const count = item.count;

                        if (layer === 1 && count === 1) {
                            // Place the single seed at the center
                            const seedElement = document.createElement('div');
                            seedElement.classList.add('seed');
                            seedElement.style.left = `${centerX - 5}px`;
                            seedElement.style.top = `${centerY - 5}px`;
                            holeElement.appendChild(seedElement);
                        } else {
                            const angleStep = (Math.PI * 2) / count;
                            const radius = radiusStep * (layer - 1) + 10; // Increase radius for each layer

                            for (let s = 0; s < count; s++) {
                                const angle = s * angleStep;
                                const x = centerX + radius * Math.cos(angle) - 5; // Adjust for seed size
                                const y = centerY + radius * Math.sin(angle) - 5;
                                const seedElement = document.createElement('div');
                                seedElement.classList.add('seed');
                                seedElement.style.left = `${x}px`;
                                seedElement.style.top = `${y}px`;
                                holeElement.appendChild(seedElement);
                            }
                        }
                    });
                }
            }
            document.getElementById('store1').textContent = board.store1;
            document.getElementById('store2').textContent = board.store2;

            // Update the current turn text and color
            const currentTurnElement = document.getElementById('current-turn');
            if (currentPlayer === 'player1') {
                currentTurnElement.textContent = "Player 1's Turn";
                currentTurnElement.style.color = "#0000FF"; // Blue
            } else {
                currentTurnElement.textContent = "Player 2's Turn";
                currentTurnElement.style.color = "#FF0000"; // Red
            }
        }

        function isOwnHole(player, index) {
            return (player === 'player1' && index >= 0 && index <= 5) ||
                   (player === 'player2' && index >= 6 && index <= 11);
        }

        function oppositePlayer(player) {
            return player === 'player1' ? 'player2' : 'player1';
        }

        function captureSeeds(player, index) {
            let seedsCaptured = 0;
            let captureIndex = index;
            let maxCaptures = 5; // Maximum of 5 houses can be captured

            // Check if the last seed landed in an opponent's hole with 2 or 3 seeds
            if (!isOwnHole(player, captureIndex) && (board.holes[captureIndex] === 2 || board.holes[captureIndex] === 3)) {
                while (maxCaptures > 0 && !isOwnHole(player, captureIndex) && (board.holes[captureIndex] === 2 || board.holes[captureIndex] === 3)) {
                    seedsCaptured += board.holes[captureIndex];
                    board.holes[captureIndex] = 0;
                    captureIndex = (captureIndex - 1 + 12) % 12; // Move to the previous hole
                    maxCaptures--;
                }
            }

            if (seedsCaptured > 0) {
                if (player === 'player1') {
                    board.store1 += seedsCaptured;
                } else {
                    board.store2 += seedsCaptured;
                }
            }
        }

        function checkGameOver() {
            // Check if either player has captured 25 or more seeds
            const player1WinsByCapture = board.store1 >= 25;
            const player2WinsByCapture = board.store2 >= 25;

            if (player1WinsByCapture || player2WinsByCapture) {
                // Game over: award remaining seeds to the player with the most seeds
                const remainingSeeds = board.holes.reduce((sum, seeds) => sum + seeds, 0);
                if (board.store1 > board.store2) {
                    board.store1 += remainingSeeds;
                } else {
                    board.store2 += remainingSeeds;
                }
                board.holes.fill(0); // Clear the board

                // Display the winner
                const gameOverElement = document.getElementById('game-over');
                if (player1WinsByCapture) {
                    gameOverElement.textContent = `Game Over! Player 1 Wins by capturing 25 or more seeds (${board.store1} - ${board.store2})`;
                } else if (player2WinsByCapture) {
                    gameOverElement.textContent = `Game Over! Player 2 Wins by capturing 25 or more seeds (${board.store2} - ${board.store1})`;
                }
                gameOverElement.style.display = 'block';

                // Disable all holes
                document.querySelectorAll('.hole').forEach(hole => {
                    hole.classList.add('disabled');
                });

                return true; // Game is over
            }
            return false; // Game continues
        }

        async function moveSeeds(player, holeIndex) {
            let seeds = board.holes[holeIndex];
            board.holes[holeIndex] = 0;
            updateBoard();

            let index = holeIndex;
            let skipOriginalHole = seeds > 11; // Skip the original hole if it has more than 11 seeds

            while (seeds > 0) {
                await new Promise(resolve => setTimeout(resolve, 300));
                index = (index + 1) % 12; // Move to next hole counter-clockwise

                if (skipOriginalHole && index === holeIndex) {
                    continue; // Skip the original hole
                }

                board.holes[index]++;
                updateBoard();
                seeds--;
            }

            // After sowing, check for captures
            captureSeeds(player, index);
            updateBoard();

            // Check if the game is over
            if (checkGameOver()) {
                return;
            }

            // Switch turns
            currentPlayer = oppositePlayer(currentPlayer);
            updateBoard();
        }

        document.querySelectorAll('.hole').forEach(hole => {
            hole.addEventListener('click', () => {
                if (hole.classList.contains('disabled')) {
                    return; // Ignore clicks on disabled holes
                }

                const holeId = hole.id;
                const holeIndex = parseInt(holeId.replace('hole', ''));

                if (!isOwnHole(currentPlayer, holeIndex)) {
                    alert("You can't select your opponent's hole!");
                    return;
                }

                if (board.holes[holeIndex] === 0) {
                    alert("You can't select an empty hole!");
                    return;
                }

                moveSeeds(currentPlayer, holeIndex);
            });
        });

        updateBoard();
    </script>
</body>
</html>