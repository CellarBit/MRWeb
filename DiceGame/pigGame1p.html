<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Game of PIG</title>
    <style>
        /* Basic body styling */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            padding: 10px;
            box-sizing: border-box;
            overflow: hidden;
        }

        /* Container for the entire game content */
        .wrapper {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Main container for the game elements */
        .score-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        /* Row for each player's progress bar */
        .progress-row {
            display: flex;
            align-items: center;
            margin: 10px 0;
            width: 100%;
            max-width: 600px;
        }

        /* Container for the progress bars */
        .progress-container {
            flex: 1;
            height: 30px;
            background-color: #f3f3f3;
            border: 1px solid #ccc;
            position: relative;
            margin-left: 10px;
            
        }

        /* Progress bar styling */
        .progress-bar {
            height: 100%;
            background-color: #151791;
            width: 0%; /* Initially 0% */
        }

        /* Player label styling */
        .player-label {
            font-size: 1.2em;
            font-weight: bold;
        }

        /* Turn indicator styling */
        .turn-indicator {
            width: 40px;
            height: 40px;
            position: absolute;
            transform: translateX(23px);
            
        }

        /* Display the progress bar value */
        .progress-value {
            font-size: 1.2em;
            font-weight: bold;
            position: absolute;
            right: -30px; /* Adjust as needed */
            top: 50%;
            transform: translateY(-50%);
        }

        /* Container for the buttons */
        .buttons-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            width: 100%;
            max-width: 600px;
        }

        /* Container for the turn total */
        .turn-total-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 10px;
        }

        /* Styling for the turn total text */
        .turn-total {
            font-size: 1.2em;
            font-weight: bold;
            margin: 0;
            text-align: center;
        }

        /* Styling for the turn total number */
        .turn-total-number {
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;
            margin-top: 5px;
        }

        /* Button styling */
        .button {
            width: 200px; /* Adjust the width as needed */
            height: auto;
            cursor: pointer;
            margin: 0 5px;
        }

        .dice-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0px;
            width: 120px; /* Set a fixed width based on your image size */
            height: 120px; /* Set a fixed height based on your image size */
            flex: none; /* Prevent the container from shrinking or expanding */
        }

        #dice-image {
            max-width: 100%; /* Ensure the image doesn't exceed the container's width */
            max-height: 100%; /* Ensure the image doesn't exceed the container's height */
            object-fit: contain; /* Scale the image to fit within the container */
        }
        /* Responsive styles for screens smaller than 500px */
        @media screen and (max-width: 500px) {
            body {
                padding: 5px; /* Reduce padding for smaller screens */
            }

            .progress-container {
                height: 30px; /* Make the progress bar thinner */
            }

            .progress-row {
                width: 75%; 
            }
            .progress-value {
                font-size: 1.7em; /* Reduce font size for the progress value */
                right: -35px; /* Move the value closer to the edge */
            }

            .player-label {
                font-size: 1.5em; /* Reduce font size for player labels */
            }

            .button {
                width: 120px; /* Make buttons smaller */
            }

            #dice-image {
                width: 100px; /* Reduce dice image size */
            }
        }

        @media screen and (max-height: 500px) and (orientation: landscape) {

            .progress-row {
                width: 80%; /* Half width for progress rows */
                margin: 1%; /* Add some spacing between rows */
                transform: translateY(20%);
            }

            .buttons-container {
                width: 70%; /* Full width for buttons container */
                justify-content: space-around; /* Distribute buttons evenly */
                transform: translateY(-40%);
            }

            .dice-container {
                    
                    width: 100px; /* Set a fixed width based on your image size */
                    height: 100px; /* Set a fixed height based on your image size */
                    flex: none; /* Prevent the container from shrinking or expanding */
                    transform: translateY(-18%);
                }
            .button {
                width: 100px; /* Make buttons smaller */
            }

            #dice-image {
                width: 80px; /* Reduce dice image size */
            }

            #dice-image {
                    max-width: 80%; /* Ensure the image doesn't exceed the container's width */
                    max-height: 80%; /* Ensure the image doesn't exceed the container's height */
                    object-fit: contain; /* Scale the image to fit within the container */
                }
        }

      #fullscreen-button {
          position: fixed;
          bottom: 10px;
          right: 10px;
          padding: 10px 15px;
          font-size: 16px;
          background-color: #559c03;
          color: white;
          border: none;
          border-radius: 5px;
          cursor: pointer;
      }
       
    </style>
</head>
<body>
    <div class="score-container">
        <div class="progress-row" id="player1-row">
            <img src="Flecha.PNG" alt="Turn Indicator" class="turn-indicator" id="turn-indicator">
            <span class="player-label">Player</span>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar-p1"></div>
                <span class="progress-value" id="progress-value-p1">0</span>
            </div>
        </div>
        <div class="progress-row" id="player2-row">
            <span class="player-label"> COMP</span>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar-p2"></div>
                <span class="progress-value" id="progress-value-p2">0</span>
            </div>
        </div>
        <br>
        <br>
        <div id="dice-container" class="dice-container">
            <img src="rolling-dice.gif" alt="Rolling Dice" id="dice-image" style="display: none;">
        </div>
        <div class="buttons-container">
            <img src="roll-button.png" alt="Roll" class="button" id="roll-button">
            <div class="turn-total-container">
                <div class="turn-total">Turn Total</div>
                <div class="turn-total-number" id="turn-total-number">0</div>
            </div>
            <img src="hold-button.png" alt="Hold" class="button" id="hold-button">
        </div>
  <button id="fullscreen-button">FullScreen</button>
    </div>
    <script>
        let currentPlayer = 1;
        let turnTotal = 0;
        const playerScores = [0, 0]; // Player 1 and Player 2 scores
        const targetScore = 100;

        // JavaScript to control the turn indicator and update progress values
        const turnIndicator = document.getElementById('turn-indicator');
        const player1Row = document.getElementById('player1-row');
        const player2Row = document.getElementById('player2-row');

        function setTurn(player) {
            if (player === 1) {
                player1Row.prepend(turnIndicator); // Move the indicator to Player 1
                turnIndicator.style.marginLeft = '-70px'; // Adjust the position if needed
                document.getElementById('roll-button').style.pointerEvents = 'auto';
                document.getElementById('hold-button').style.pointerEvents = 'auto369.3*6';
            } else {
                player2Row.prepend(turnIndicator); // Move the indicator to Player 2
                turnIndicator.style.marginLeft = '-70px'; // Adjust the position if needed
                player2Turn();
            }
        }

        function player2Turn() {
            //player2Row.prepend(turnIndicator); // Move the indicator to Player 2
            //turnIndicator.style.marginLeft = '-70px'; // Adjust the position if needed
            document.getElementById('roll-button').style.pointerEvents = 'none';
            document.getElementById('hold-button').style.pointerEvents = 'none';

            function continueRolling() {
                if (currentPlayer !== 2) return;
                console.log(`Player ${currentPlayer} is rolling...`);
                rollDice();
                if (turnTotal >= 21) {
                holdScore();
return;
                
                } else {
                // Use setTimeout to avoid blocking the browser and allow for UI updates
                setTimeout(continueRolling, 2000); // Adjust the delay as needed
                }
            }

            continueRolling(); // Start rolling
        }



        function updateProgress(player, value) {
            const progressBarElement = document.getElementById(`progress-bar-p${player}`);
            const progressValueElement = document.getElementById(`progress-value-p${player}`);
            const widthPercentage = (value / targetScore) * 100;
            progressBarElement.style.width = `${widthPercentage}%`;
            progressValueElement.textContent = value;
        }


        function updateTurnTotal(value) {
            const turnTotalNumberElement = document.getElementById('turn-total-number');
            turnTotalNumberElement.textContent = value;
        }

        function rollDice() {
            console.log(`Player ${currentPlayer} is rolling the dice`);
            const diceImage = document.getElementById('dice-image');
            const diceSound = new Audio('diceSound.wav');
            diceImage.src = 'rolling-dice.gif';
            diceImage.style.display = 'block';
            diceImage.style.width = '150px'; // Ensure the width is set here
            diceImage.style.height = 'auto';

            // Disable buttons
            document.getElementById('roll-button').style.pointerEvents = 'none';
            document.getElementById('hold-button').style.pointerEvents = 'none';

            diceSound.play();

            setTimeout(() => {
                const randomDiceValue = Math.floor(Math.random() * 6) + 1;
                const lowtone = new Audio('lowtone.wav');
                diceImage.src = `dice${randomDiceValue}.png`;
                diceImage.style.width = '100px'; // Keep the same width for PNG images
                diceImage.style.height = 'auto';
                console.log(`Player ${currentPlayer} got a ${randomDiceValue}`);
                document.getElementById('roll-button').style.pointerEvents = 'auto';
                document.getElementById('hold-button').style.pointerEvents = 'auto';

                if (randomDiceValue === 1) {
                    lowtone.play();
                    lowtone.onended = () => {
                        turnTotal = 0;
                        updateTurnTotal(turnTotal);
                        switchTurn();
                    }; 
                    
                     
                } else {
                    turnTotal += randomDiceValue;
                    updateTurnTotal(turnTotal);
                    checkScore(turnTotal);
                    return turnTotal;
                }

            }, 1000);
            // Enable buttons
            

        }

        function checkScore(turnTotal) {
            const finish = new Audio('finish.wav');
            const cry = new Audio('cry.wav');
            if (playerScores[currentPlayer - 1] + turnTotal >= targetScore) {
                updateProgress(currentPlayer, targetScore);
                if (currentPlayer == 1){
                    finish.play();
                    finish.onended = () => {
                        alert(`THE WINNER!`);
                        location.reload();
                    };   
                } else{
                    cry.play();
                    cry.onended = () => {
                        alert('THE LOSER!')
                        location.reload();
                    }
                }
                    
                            
            }
        }

        function holdScore() {
            document.getElementById('roll-button').style.pointerEvents = 'none';
            document.getElementById('hold-button').style.pointerEvents = 'none';
            const holdScore = new Audio('holdScore.wav');
            playerScores[currentPlayer - 1] += turnTotal;
            updateProgress(currentPlayer, playerScores[currentPlayer - 1]);
            holdScore.play();
            holdScore.onended = () => {             
                turnTotal = 0;
                updateTurnTotal(turnTotal);
                switchTurn();
                document.getElementById('roll-button').style.pointerEvents = 'auto';
                document.getElementById('hold-button').style.pointerEvents = 'auto';
            };
        }

        function switchTurn() {
            currentPlayer = currentPlayer === 1 ? 2 : 1;
            console.log(`Switching to Player ${currentPlayer}`);
            setTurn(currentPlayer);
        }

        function resetGame() {
            playerScores[0] = 0;
            playerScores[1] = 0;
            updateProgress(1, 0);
            updateProgress(2, 0);
            turnTotal = 0;
            updateTurnTotal(turnTotal);
            setTurn(1);
        }
            // Add the event listener for the fullscreen button
            document.getElementById('fullscreen-button').addEventListener('click', () => {
            if (document.documentElement.requestFullscreen) {
                document.documentElement.requestFullscreen();
            } else if (document.documentElement.mozRequestFullScreen) { // Firefox
                document.documentElement.mozRequestFullScreen();
            } else if (document.documentElement.webkitRequestFullscreen) { // Chrome, Safari, and Opera
                document.documentElement.webkitRequestFullscreen();
            } else if (document.documentElement.msRequestFullscreen) { // IE/Edge
                document.documentElement.msRequestFullscreen();
            }
        });

        // Add the event listener for the fullscreen change
        document.addEventListener('fullscreenchange', () => {
            if (document.fullscreenElement) {
                document.getElementById('fullscreen-button').style.display = 'none';
            } else {
                document.getElementById('fullscreen-button').style.display = 'block';
            }
        });

        document.addEventListener('mozfullscreenchange', () => { // Firefox
            if (document.mozFullScreenElement) {
                document.getElementById('fullscreen-button').style.display = 'none';
            } else {
                document.getElementById('fullscreen-button').style.display = 'block';
            }
        });

        document.addEventListener('webkitfullscreenchange', () => { // Chrome, Safari, and Opera
            if (document.webkitFullscreenElement) {
                document.getElementById('fullscreen-button').style.display = 'none';
            } else {
                document.getElementById('fullscreen-button').style.display = 'block';
            }
        });

        document.addEventListener('msfullscreenchange', () => { // IE/Edge
            if (document.msFullscreenElement) {
                document.getElementById('fullscreen-button').style.display = 'none';
            } else {
                document.getElementById('fullscreen-button').style.display = 'block';
            }
        });

        document.getElementById('roll-button').addEventListener('click', rollDice);
        document.getElementById('hold-button').addEventListener('click', holdScore);

        // Initialize game
        resetGame();
        
    </script>
</body>
</html>
